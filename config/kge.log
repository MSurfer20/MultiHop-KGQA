2022-03-13 08:23:22.345629 Using folder: ./config
2022-03-13 08:23:22.364084 Loading configuration of dataset fbwq_full from /home2/samyak.ja/M_EmbedKGQA/kge/data/fbwq_full ...
2022-03-13 08:23:22.646936 Loaded 1886683 keys from map entity_ids
2022-03-13 08:23:22.658695 Loaded 572 keys from map relation_ids
2022-03-13 08:23:23.305789 Loaded 5780246 train triples
2022-03-13 08:23:23.318049 Loaded 20000 valid triples
2022-03-13 08:23:23.322225 Loaded 20000 test triples
2022-03-13 08:23:37.057486 [ae9248f9] Initializing 1-to-N training job...
2022-03-13 08:23:37.173951 [ae9248f9] No checkpoint found or specified, starting from scratch...
2022-03-13 08:23:37.174660 [ae9248f9] Configuration:
2022-03-13 08:23:37.185715 [ae9248f9]   1vsAll:
2022-03-13 08:23:37.185751 [ae9248f9]     class_name: TrainingJob1vsAll
2022-03-13 08:23:37.185780 [ae9248f9]   KvsAll:
2022-03-13 08:23:37.185791 [ae9248f9]     class_name: TrainingJobKvsAll
2022-03-13 08:23:37.185801 [ae9248f9]     label_smoothing: 0.0
2022-03-13 08:23:37.185811 [ae9248f9]     query_types:
2022-03-13 08:23:37.185821 [ae9248f9]       _po: true
2022-03-13 08:23:37.185831 [ae9248f9]       s_o: false
2022-03-13 08:23:37.185841 [ae9248f9]       sp_: true
2022-03-13 08:23:37.185868 [ae9248f9]   ax_search:
2022-03-13 08:23:37.185896 [ae9248f9]     class_name: AxSearchJob
2022-03-13 08:23:37.185907 [ae9248f9]     num_sobol_trials: -1
2022-03-13 08:23:37.185934 [ae9248f9]     num_trials: 10
2022-03-13 08:23:37.185944 [ae9248f9]     parameter_constraints: []
2022-03-13 08:23:37.185954 [ae9248f9]     parameters: []
2022-03-13 08:23:37.185982 [ae9248f9]     sobol_seed: 0
2022-03-13 08:23:37.185993 [ae9248f9]   console:
2022-03-13 08:23:37.186003 [ae9248f9]     format: {}
2022-03-13 08:23:37.186014 [ae9248f9]     quiet: false
2022-03-13 08:23:37.186024 [ae9248f9]   dataset:
2022-03-13 08:23:37.186035 [ae9248f9]     +++: +++
2022-03-13 08:23:37.186045 [ae9248f9]     files:
2022-03-13 08:23:37.186056 [ae9248f9]       +++: +++
2022-03-13 08:23:37.186066 [ae9248f9]       entity_ids:
2022-03-13 08:23:37.186077 [ae9248f9]         filename: entity_ids.del
2022-03-13 08:23:37.186087 [ae9248f9]         type: map
2022-03-13 08:23:37.186097 [ae9248f9]       entity_strings:
2022-03-13 08:23:37.186108 [ae9248f9]         filename: entity_ids.del
2022-03-13 08:23:37.186118 [ae9248f9]         type: map
2022-03-13 08:23:37.186129 [ae9248f9]       relation_ids:
2022-03-13 08:23:37.186139 [ae9248f9]         filename: relation_ids.del
2022-03-13 08:23:37.186150 [ae9248f9]         type: map
2022-03-13 08:23:37.186160 [ae9248f9]       relation_strings:
2022-03-13 08:23:37.186171 [ae9248f9]         filename: relation_ids.del
2022-03-13 08:23:37.186181 [ae9248f9]         type: map
2022-03-13 08:23:37.186192 [ae9248f9]       test:
2022-03-13 08:23:37.186202 [ae9248f9]         filename: test.del
2022-03-13 08:23:37.186213 [ae9248f9]         size: 20000
2022-03-13 08:23:37.186224 [ae9248f9]         type: triples
2022-03-13 08:23:37.186234 [ae9248f9]       test_without_unseen:
2022-03-13 08:23:37.186245 [ae9248f9]         filename: test_without_unseen.del
2022-03-13 08:23:37.186256 [ae9248f9]         size: 20000
2022-03-13 08:23:37.186266 [ae9248f9]         type: triples
2022-03-13 08:23:37.186277 [ae9248f9]       train:
2022-03-13 08:23:37.186287 [ae9248f9]         filename: train.del
2022-03-13 08:23:37.186298 [ae9248f9]         size: 5780246
2022-03-13 08:23:37.186308 [ae9248f9]         type: triples
2022-03-13 08:23:37.186318 [ae9248f9]       train_sample:
2022-03-13 08:23:37.186329 [ae9248f9]         filename: train_sample.del
2022-03-13 08:23:37.186339 [ae9248f9]         size: 20000
2022-03-13 08:23:37.186350 [ae9248f9]         type: triples
2022-03-13 08:23:37.186360 [ae9248f9]       valid:
2022-03-13 08:23:37.186370 [ae9248f9]         filename: valid.del
2022-03-13 08:23:37.186381 [ae9248f9]         size: 20000
2022-03-13 08:23:37.186391 [ae9248f9]         type: triples
2022-03-13 08:23:37.186401 [ae9248f9]       valid_without_unseen:
2022-03-13 08:23:37.186412 [ae9248f9]         filename: valid_without_unseen.del
2022-03-13 08:23:37.186422 [ae9248f9]         size: 20000
2022-03-13 08:23:37.186433 [ae9248f9]         type: triples
2022-03-13 08:23:37.186443 [ae9248f9]     name: fbwq_full
2022-03-13 08:23:37.186454 [ae9248f9]     num_entities: 1886683
2022-03-13 08:23:37.186464 [ae9248f9]     num_relations: 572
2022-03-13 08:23:37.186476 [ae9248f9]     pickle: true
2022-03-13 08:23:37.186486 [ae9248f9]   entity_ranking:
2022-03-13 08:23:37.186497 [ae9248f9]     chunk_size: -1
2022-03-13 08:23:37.186507 [ae9248f9]     class_name: EntityRankingJob
2022-03-13 08:23:37.186517 [ae9248f9]     filter_splits:
2022-03-13 08:23:37.186528 [ae9248f9]     - train
2022-03-13 08:23:37.186539 [ae9248f9]     - valid
2022-03-13 08:23:37.186549 [ae9248f9]     filter_with_test: true
2022-03-13 08:23:37.186559 [ae9248f9]     hits_at_k_s:
2022-03-13 08:23:37.186570 [ae9248f9]     - 1
2022-03-13 08:23:37.186580 [ae9248f9]     - 3
2022-03-13 08:23:37.186591 [ae9248f9]     - 10
2022-03-13 08:23:37.186601 [ae9248f9]     - 50
2022-03-13 08:23:37.186611 [ae9248f9]     - 100
2022-03-13 08:23:37.186622 [ae9248f9]     - 200
2022-03-13 08:23:37.186633 [ae9248f9]     - 300
2022-03-13 08:23:37.186643 [ae9248f9]     - 400
2022-03-13 08:23:37.186653 [ae9248f9]     - 500
2022-03-13 08:23:37.186664 [ae9248f9]     - 1000
2022-03-13 08:23:37.186674 [ae9248f9]     metrics_per:
2022-03-13 08:23:37.186685 [ae9248f9]       argument_frequency: false
2022-03-13 08:23:37.186696 [ae9248f9]       head_and_tail: false
2022-03-13 08:23:37.186706 [ae9248f9]       relation_type: false
2022-03-13 08:23:37.186716 [ae9248f9]     tie_handling:
2022-03-13 08:23:37.186727 [ae9248f9]       atol: 1e-05
2022-03-13 08:23:37.186737 [ae9248f9]       rtol: 1e-04
2022-03-13 08:23:37.186748 [ae9248f9]       type: rounded_mean_rank
2022-03-13 08:23:37.186758 [ae9248f9]       warn_only: true
2022-03-13 08:23:37.186769 [ae9248f9]   eval:
2022-03-13 08:23:37.186779 [ae9248f9]     batch_size: 100
2022-03-13 08:23:37.186790 [ae9248f9]     num_workers: 0
2022-03-13 08:23:37.186800 [ae9248f9]     pin_memory: false
2022-03-13 08:23:37.186810 [ae9248f9]     split: valid
2022-03-13 08:23:37.186821 [ae9248f9]     trace_level: epoch
2022-03-13 08:23:37.186831 [ae9248f9]     type: entity_ranking
2022-03-13 08:23:37.186842 [ae9248f9]   grid_search:
2022-03-13 08:23:37.186852 [ae9248f9]     class_name: GridSearchJob
2022-03-13 08:23:37.186862 [ae9248f9]     parameters:
2022-03-13 08:23:37.186873 [ae9248f9]       +++: +++
2022-03-13 08:23:37.186883 [ae9248f9]     run: true
2022-03-13 08:23:37.186893 [ae9248f9]   import:
2022-03-13 08:23:37.186904 [ae9248f9]   - simple
2022-03-13 08:23:37.186914 [ae9248f9]   job:
2022-03-13 08:23:37.186925 [ae9248f9]     device: cuda
2022-03-13 08:23:37.186935 [ae9248f9]     type: train
2022-03-13 08:23:37.186945 [ae9248f9]   lookup_embedder:
2022-03-13 08:23:37.186956 [ae9248f9]     class_name: LookupEmbedder
2022-03-13 08:23:37.186966 [ae9248f9]     dim: 100
2022-03-13 08:23:37.186977 [ae9248f9]     dropout: 0.0
2022-03-13 08:23:37.186987 [ae9248f9]     initialize: normal_
2022-03-13 08:23:37.186998 [ae9248f9]     initialize_args:
2022-03-13 08:23:37.187008 [ae9248f9]       +++: +++
2022-03-13 08:23:37.187019 [ae9248f9]     normalize:
2022-03-13 08:23:37.187029 [ae9248f9]       p: -1.0
2022-03-13 08:23:37.187039 [ae9248f9]     pretrain:
2022-03-13 08:23:37.187050 [ae9248f9]       ensure_all: false
2022-03-13 08:23:37.187060 [ae9248f9]       model_filename: ''
2022-03-13 08:23:37.187070 [ae9248f9]     regularize: lp
2022-03-13 08:23:37.187081 [ae9248f9]     regularize_args:
2022-03-13 08:23:37.187091 [ae9248f9]       +++: +++
2022-03-13 08:23:37.187101 [ae9248f9]       p: 2
2022-03-13 08:23:37.187112 [ae9248f9]       weighted: false
2022-03-13 08:23:37.187122 [ae9248f9]     regularize_weight: 0.0
2022-03-13 08:23:37.187133 [ae9248f9]     round_dim_to: []
2022-03-13 08:23:37.187143 [ae9248f9]     sparse: false
2022-03-13 08:23:37.187154 [ae9248f9]   manual_search:
2022-03-13 08:23:37.187164 [ae9248f9]     class_name: ManualSearchJob
2022-03-13 08:23:37.187175 [ae9248f9]     configurations: []
2022-03-13 08:23:37.187186 [ae9248f9]     run: true
2022-03-13 08:23:37.187196 [ae9248f9]   model: simple
2022-03-13 08:23:37.187207 [ae9248f9]   modules:
2022-03-13 08:23:37.187217 [ae9248f9]   - kge.job
2022-03-13 08:23:37.187227 [ae9248f9]   - kge.model
2022-03-13 08:23:37.187238 [ae9248f9]   - kge.model.embedder
2022-03-13 08:23:37.187248 [ae9248f9]   negative_sampling:
2022-03-13 08:23:37.187259 [ae9248f9]     class_name: TrainingJobNegativeSampling
2022-03-13 08:23:37.187269 [ae9248f9]     filtering:
2022-03-13 08:23:37.187280 [ae9248f9]       implementation: fast_if_available
2022-03-13 08:23:37.187290 [ae9248f9]       o: false
2022-03-13 08:23:37.187301 [ae9248f9]       p: false
2022-03-13 08:23:37.187320 [ae9248f9]       s: false
2022-03-13 08:23:37.187331 [ae9248f9]       split: ''
2022-03-13 08:23:37.187341 [ae9248f9]     frequency:
2022-03-13 08:23:37.187352 [ae9248f9]       smoothing: 1
2022-03-13 08:23:37.187362 [ae9248f9]     implementation: auto
2022-03-13 08:23:37.187373 [ae9248f9]     num_samples:
2022-03-13 08:23:37.187383 [ae9248f9]       o: -1
2022-03-13 08:23:37.187393 [ae9248f9]       p: 0
2022-03-13 08:23:37.187404 [ae9248f9]       s: 3
2022-03-13 08:23:37.187414 [ae9248f9]     sampling_type: uniform
2022-03-13 08:23:37.187425 [ae9248f9]     shared: false
2022-03-13 08:23:37.187435 [ae9248f9]     shared_type: default
2022-03-13 08:23:37.187445 [ae9248f9]     with_replacement: true
2022-03-13 08:23:37.187456 [ae9248f9]   random_seed:
2022-03-13 08:23:37.187466 [ae9248f9]     default: -1
2022-03-13 08:23:37.187487 [ae9248f9]     numba: -1
2022-03-13 08:23:37.187499 [ae9248f9]     numpy: -1
2022-03-13 08:23:37.187510 [ae9248f9]     python: -1
2022-03-13 08:23:37.187520 [ae9248f9]     torch: -1
2022-03-13 08:23:37.187530 [ae9248f9]   search:
2022-03-13 08:23:37.187541 [ae9248f9]     device_pool:
2022-03-13 08:23:37.187552 [ae9248f9]     - cuda:0
2022-03-13 08:23:37.187563 [ae9248f9]     - cuda:1
2022-03-13 08:23:37.187574 [ae9248f9]     - cuda:2
2022-03-13 08:23:37.187584 [ae9248f9]     - cuda:3
2022-03-13 08:23:37.187595 [ae9248f9]     num_workers: 1
2022-03-13 08:23:37.187606 [ae9248f9]     on_error: abort
2022-03-13 08:23:37.187616 [ae9248f9]     type: ax_search
2022-03-13 08:23:37.187627 [ae9248f9]   simple:
2022-03-13 08:23:37.187638 [ae9248f9]     class_name: SimplE
2022-03-13 08:23:37.187648 [ae9248f9]     entity_embedder:
2022-03-13 08:23:37.187659 [ae9248f9]       +++: +++
2022-03-13 08:23:37.187669 [ae9248f9]       type: lookup_embedder
2022-03-13 08:23:37.187680 [ae9248f9]     relation_embedder:
2022-03-13 08:23:37.187690 [ae9248f9]       +++: +++
2022-03-13 08:23:37.187700 [ae9248f9]       type: lookup_embedder
2022-03-13 08:23:37.187711 [ae9248f9]   train:
2022-03-13 08:23:37.187721 [ae9248f9]     abort_on_nan: true
2022-03-13 08:23:37.187732 [ae9248f9]     auto_correct: false
2022-03-13 08:23:37.187742 [ae9248f9]     batch_size: 32
2022-03-13 08:23:37.187753 [ae9248f9]     checkpoint:
2022-03-13 08:23:37.187763 [ae9248f9]       every: 5
2022-03-13 08:23:37.187773 [ae9248f9]       keep: 3
2022-03-13 08:23:37.187800 [ae9248f9]       keep_init: true
2022-03-13 08:23:37.187810 [ae9248f9]     loss: kl
2022-03-13 08:23:37.187820 [ae9248f9]     loss_arg: .nan
2022-03-13 08:23:37.187830 [ae9248f9]     lr_scheduler: ''
2022-03-13 08:23:37.187840 [ae9248f9]     lr_scheduler_args:
2022-03-13 08:23:37.187850 [ae9248f9]       +++: +++
2022-03-13 08:23:37.187861 [ae9248f9]     lr_warmup: 0
2022-03-13 08:23:37.187871 [ae9248f9]     max_epochs: 5
2022-03-13 08:23:37.187881 [ae9248f9]     num_workers: 5
2022-03-13 08:23:37.187891 [ae9248f9]     optimizer:
2022-03-13 08:23:37.187901 [ae9248f9]       +++: +++
2022-03-13 08:23:37.187911 [ae9248f9]       default:
2022-03-13 08:23:37.187921 [ae9248f9]         args:
2022-03-13 08:23:37.187931 [ae9248f9]           +++: +++
2022-03-13 08:23:37.187941 [ae9248f9]           lr: 0.1
2022-03-13 08:23:37.187951 [ae9248f9]           weight_decay: 4.0e-08
2022-03-13 08:23:37.187962 [ae9248f9]         type: Adagrad
2022-03-13 08:23:37.187972 [ae9248f9]     pin_memory: false
2022-03-13 08:23:37.187982 [ae9248f9]     split: train
2022-03-13 08:23:37.187992 [ae9248f9]     subbatch_auto_tune: true
2022-03-13 08:23:37.188003 [ae9248f9]     subbatch_size: -1
2022-03-13 08:23:37.188013 [ae9248f9]     trace_level: epoch
2022-03-13 08:23:37.188023 [ae9248f9]     type: KvsAll
2022-03-13 08:23:37.188033 [ae9248f9]     visualize_graph: false
2022-03-13 08:23:37.188043 [ae9248f9]   training_loss:
2022-03-13 08:23:37.188054 [ae9248f9]     class_name: TrainingLossEvaluationJob
2022-03-13 08:23:37.188064 [ae9248f9]   user:
2022-03-13 08:23:37.188074 [ae9248f9]     +++: +++
2022-03-13 08:23:37.188085 [ae9248f9]   valid:
2022-03-13 08:23:37.188095 [ae9248f9]     early_stopping:
2022-03-13 08:23:37.188105 [ae9248f9]       patience: 5
2022-03-13 08:23:37.188115 [ae9248f9]       threshold:
2022-03-13 08:23:37.188125 [ae9248f9]         epochs: 0
2022-03-13 08:23:37.188136 [ae9248f9]         metric_value: 0.0
2022-03-13 08:23:37.188146 [ae9248f9]     every: 1
2022-03-13 08:23:37.188156 [ae9248f9]     metric: mean_reciprocal_rank_filtered
2022-03-13 08:23:37.188167 [ae9248f9]     metric_expr: float("nan")
2022-03-13 08:23:37.188177 [ae9248f9]     metric_max: true
2022-03-13 08:23:37.188187 [ae9248f9]     split: valid
2022-03-13 08:23:37.188197 [ae9248f9]     trace_level: epoch
2022-03-13 08:23:37.297849 [ae9248f9]   git commit: 5619f4b
2022-03-13 08:23:40.794382 [ae9248f9]   3658662 distinct sp pairs in train
2022-03-13 08:23:41.289815 [ae9248f9]   996243 distinct po pairs in train
2022-03-13 08:23:41.290742 [ae9248f9] Saving checkpoint to ./config/checkpoint_00000.pt...
2022-03-13 08:23:59.226109 [ae9248f9] Starting training...
2022-03-13 08:23:59.227118 [ae9248f9] Starting epoch 1...
2022-03-13 08:24:00.052278 [ae9248f9] CUDA memory after first batch: allocated= 2,265,611,264 reserved= 7,983,857,664 max_allocated= 5,911,909,376
2022-03-13 13:17:04.207651 [ae9248f9] avg_cost: 3.7819551375619
2022-03-13 13:17:04.207678 [ae9248f9] avg_loss: 3.7819551375619
2022-03-13 13:17:04.207683 [ae9248f9] avg_penalties: {}
2022-03-13 13:17:04.207686 [ae9248f9] avg_penalty: 0.0
2022-03-13 13:17:04.207690 [ae9248f9] backward_time: 4639.422996520996
2022-03-13 13:17:04.207694 [ae9248f9] batches: 145466
2022-03-13 13:17:04.207698 [ae9248f9] entry_id: 0fa2af96-879d-4427-a236-dccc1a96510e
2022-03-13 13:17:04.207702 [ae9248f9] epoch: 1
2022-03-13 13:17:04.207705 [ae9248f9] epoch_time: 17584.974452972412
2022-03-13 13:17:04.207709 [ae9248f9] event: epoch_completed
2022-03-13 13:17:04.207713 [ae9248f9] forward_time: 9733.603151082993
2022-03-13 13:17:04.207717 [ae9248f9] job: train
2022-03-13 13:17:04.207720 [ae9248f9] job_id: ae9248f9-5434-4388-850b-62dd4b5337cb
2022-03-13 13:17:04.207724 [ae9248f9] lr:
2022-03-13 13:17:04.207743 [ae9248f9] - 0.1
2022-03-13 13:17:04.207748 [ae9248f9] num_parameters: 188725500
2022-03-13 13:17:04.207752 [ae9248f9] optimizer_time: 35.72953510284424
2022-03-13 13:17:04.207773 [ae9248f9] other_time: 232.48437762260437
2022-03-13 13:17:04.207776 [ae9248f9] prepare_time: 2943.734392642975
2022-03-13 13:17:04.207779 [ae9248f9] scope: epoch
2022-03-13 13:17:04.207783 [ae9248f9] size: 4654905
2022-03-13 13:17:04.207804 [ae9248f9] split: train
2022-03-13 13:17:04.207807 [ae9248f9] timestamp: 1647157624.2027376
2022-03-13 13:17:04.207810 [ae9248f9] type: KvsAll
2022-03-13 13:17:04.231300 [ae9248f9]   avg_cost: 3.7819551375619
2022-03-13 13:17:04.231357 [ae9248f9]   avg_loss: 3.7819551375619
2022-03-13 13:17:04.231371 [ae9248f9]   avg_penalties: {}
2022-03-13 13:17:04.231383 [ae9248f9]   avg_penalty: 0.0
2022-03-13 13:17:04.231396 [ae9248f9]   backward_time: 4639.422996520996
2022-03-13 13:17:04.231407 [ae9248f9]   batches: 145466
2022-03-13 13:17:04.231438 [ae9248f9]   entry_id: 0fa2af96-879d-4427-a236-dccc1a96510e
2022-03-13 13:17:04.231451 [ae9248f9]   epoch: 1
2022-03-13 13:17:04.231463 [ae9248f9]   epoch_time: 17584.974452972412
2022-03-13 13:17:04.231507 [ae9248f9]   event: epoch_completed
2022-03-13 13:17:04.231557 [ae9248f9]   forward_time: 9733.603151082993
2022-03-13 13:17:04.231571 [ae9248f9]   job: train
2022-03-13 13:17:04.231584 [ae9248f9]   job_id: ae9248f9-5434-4388-850b-62dd4b5337cb
2022-03-13 13:17:04.231596 [ae9248f9]   lr:
2022-03-13 13:17:04.231609 [ae9248f9]   - 0.1
2022-03-13 13:17:04.231622 [ae9248f9]   num_parameters: 188725500
2022-03-13 13:17:04.231634 [ae9248f9]   optimizer_time: 35.72953510284424
2022-03-13 13:17:04.231646 [ae9248f9]   other_time: 232.48437762260437
2022-03-13 13:17:04.231658 [ae9248f9]   prepare_time: 2943.734392642975
2022-03-13 13:17:04.231671 [ae9248f9]   scope: epoch
2022-03-13 13:17:04.231683 [ae9248f9]   size: 4654905
2022-03-13 13:17:04.231696 [ae9248f9]   split: train
2022-03-13 13:17:04.231708 [ae9248f9]   timestamp: 1647157624.2027376
2022-03-13 13:17:04.231720 [ae9248f9]   type: KvsAll
2022-03-13 13:17:04.232467 [ae9248f9] Finished epoch 1.
2022-03-13 13:17:04.294709 [ae9248f9]   17260 distinct sp pairs in valid
2022-03-13 13:17:04.304796 [ae9248f9]   6772 distinct po pairs in valid
2022-03-13 13:17:04.314376 [ae9248f9]   17265 distinct sp pairs in test
2022-03-13 13:17:04.318991 [ae9248f9]   6840 distinct po pairs in test
2022-03-13 13:17:04.319998 [7ed40671] Evaluating on valid data (epoch 1)...
2022-03-13 13:17:05.338988 [ae9248f9] Traceback (most recent call last):
2022-03-13 13:17:05.339027 [ae9248f9]   File "/home2/samyak.ja/M_EmbedKGQA/kge/kge/cli.py", line 286, in main
2022-03-13 13:17:05.339031 [ae9248f9]     job.run()
2022-03-13 13:17:05.339034 [ae9248f9]   File "/home2/samyak.ja/M_EmbedKGQA/kge/kge/job/job.py", line 159, in run
2022-03-13 13:17:05.339038 [ae9248f9]     result = self._run()
2022-03-13 13:17:05.339041 [ae9248f9]   File "/home2/samyak.ja/M_EmbedKGQA/kge/kge/job/train.py", line 222, in _run
2022-03-13 13:17:05.339044 [ae9248f9]     trace_entry = self.valid_job.run()
2022-03-13 13:17:05.339047 [ae9248f9]   File "/home2/samyak.ja/M_EmbedKGQA/kge/kge/job/job.py", line 159, in run
2022-03-13 13:17:05.339050 [ae9248f9]     result = self._run()
2022-03-13 13:17:05.339053 [ae9248f9]   File "/home2/samyak.ja/M_EmbedKGQA/kge/kge/job/eval.py", line 67, in _run
2022-03-13 13:17:05.339056 [ae9248f9]     self._evaluate()
2022-03-13 13:17:05.339060 [ae9248f9]   File "/home2/samyak.ja/anaconda3/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 26, in decorate_context
2022-03-13 13:17:05.339063 [ae9248f9]     return func(*args, **kwargs)
2022-03-13 13:17:05.339066 [ae9248f9]   File "/home2/samyak.ja/M_EmbedKGQA/kge/kge/job/eval_entity_ranking.py", line 301, in _evaluate
2022-03-13 13:17:05.339069 [ae9248f9]     ) = self._filter_and_rank(
2022-03-13 13:17:05.339073 [ae9248f9]   File "/home2/samyak.ja/M_EmbedKGQA/kge/kge/job/eval_entity_ranking.py", line 567, in _filter_and_rank
2022-03-13 13:17:05.339076 [ae9248f9]     o_rank, o_num_ties = self._get_ranks_and_num_ties(scores_sp, o_true_scores)
2022-03-13 13:17:05.339079 [ae9248f9]   File "/home2/samyak.ja/M_EmbedKGQA/kge/kge/job/eval_entity_ranking.py", line 590, in _get_ranks_and_num_ties
2022-03-13 13:17:05.339082 [ae9248f9]     is_close = torch.isclose(
2022-03-13 13:17:05.339085 [ae9248f9] RuntimeError: CUDA out of memory. Tried to allocate 720.00 MiB (GPU 0; 10.76 GiB total capacity; 8.72 GiB already allocated; 400.56 MiB free; 9.37 GiB reserved in total by PyTorch)
2022-03-15 22:34:26.860450 Using folder: ./config
2022-03-15 22:34:26.891118 Loading configuration of dataset fbwq_full from /home2/samyak.ja/M_EmbedKGQA/kge/data/fbwq_full ...
2022-03-15 22:34:27.181381 Loaded 1886683 keys from map entity_ids
2022-03-15 22:34:27.190834 Loaded 572 keys from map relation_ids
2022-03-15 22:34:27.832907 Loaded 5780246 train triples
2022-03-15 22:34:27.847909 Loaded 20000 valid triples
2022-03-15 22:34:27.852806 Loaded 20000 test triples
2022-03-15 22:34:44.039914 [926659ed] Initializing 1-to-N training job...
2022-03-15 22:34:44.136581 [926659ed] No checkpoint found or specified, starting from scratch...
2022-03-15 22:34:44.137399 [926659ed] Configuration:
2022-03-15 22:34:44.148694 [926659ed]   1vsAll:
2022-03-15 22:34:44.148727 [926659ed]     class_name: TrainingJob1vsAll
2022-03-15 22:34:44.148745 [926659ed]   KvsAll:
2022-03-15 22:34:44.148761 [926659ed]     class_name: TrainingJobKvsAll
2022-03-15 22:34:44.148776 [926659ed]     label_smoothing: 0.0
2022-03-15 22:34:44.148791 [926659ed]     query_types:
2022-03-15 22:34:44.148807 [926659ed]       _po: true
2022-03-15 22:34:44.148828 [926659ed]       s_o: false
2022-03-15 22:34:44.148834 [926659ed]       sp_: true
2022-03-15 22:34:44.148839 [926659ed]   ax_search:
2022-03-15 22:34:44.148844 [926659ed]     class_name: AxSearchJob
2022-03-15 22:34:44.148850 [926659ed]     num_sobol_trials: -1
2022-03-15 22:34:44.148855 [926659ed]     num_trials: 10
2022-03-15 22:34:44.148860 [926659ed]     parameter_constraints: []
2022-03-15 22:34:44.148866 [926659ed]     parameters: []
2022-03-15 22:34:44.148871 [926659ed]     sobol_seed: 0
2022-03-15 22:34:44.148876 [926659ed]   console:
2022-03-15 22:34:44.148881 [926659ed]     format: {}
2022-03-15 22:34:44.148886 [926659ed]     quiet: false
2022-03-15 22:34:44.148892 [926659ed]   dataset:
2022-03-15 22:34:44.148897 [926659ed]     +++: +++
2022-03-15 22:34:44.148903 [926659ed]     files:
2022-03-15 22:34:44.148908 [926659ed]       +++: +++
2022-03-15 22:34:44.148913 [926659ed]       entity_ids:
2022-03-15 22:34:44.148919 [926659ed]         filename: entity_ids.del
2022-03-15 22:34:44.148924 [926659ed]         type: map
2022-03-15 22:34:44.148929 [926659ed]       entity_strings:
2022-03-15 22:34:44.148935 [926659ed]         filename: entity_ids.del
2022-03-15 22:34:44.148940 [926659ed]         type: map
2022-03-15 22:34:44.148945 [926659ed]       relation_ids:
2022-03-15 22:34:44.148951 [926659ed]         filename: relation_ids.del
2022-03-15 22:34:44.148956 [926659ed]         type: map
2022-03-15 22:34:44.148962 [926659ed]       relation_strings:
2022-03-15 22:34:44.148967 [926659ed]         filename: relation_ids.del
2022-03-15 22:34:44.148972 [926659ed]         type: map
2022-03-15 22:34:44.148978 [926659ed]       test:
2022-03-15 22:34:44.148983 [926659ed]         filename: test.del
2022-03-15 22:34:44.148988 [926659ed]         size: 20000
2022-03-15 22:34:44.148993 [926659ed]         type: triples
2022-03-15 22:34:44.148999 [926659ed]       test_without_unseen:
2022-03-15 22:34:44.149004 [926659ed]         filename: test_without_unseen.del
2022-03-15 22:34:44.149009 [926659ed]         size: 20000
2022-03-15 22:34:44.149015 [926659ed]         type: triples
2022-03-15 22:34:44.149020 [926659ed]       train:
2022-03-15 22:34:44.149026 [926659ed]         filename: train.del
2022-03-15 22:34:44.149031 [926659ed]         size: 5780246
2022-03-15 22:34:44.149037 [926659ed]         type: triples
2022-03-15 22:34:44.149042 [926659ed]       train_sample:
2022-03-15 22:34:44.149047 [926659ed]         filename: train_sample.del
2022-03-15 22:34:44.149052 [926659ed]         size: 20000
2022-03-15 22:34:44.149058 [926659ed]         type: triples
2022-03-15 22:34:44.149063 [926659ed]       valid:
2022-03-15 22:34:44.149068 [926659ed]         filename: valid.del
2022-03-15 22:34:44.149074 [926659ed]         size: 20000
2022-03-15 22:34:44.149079 [926659ed]         type: triples
2022-03-15 22:34:44.149085 [926659ed]       valid_without_unseen:
2022-03-15 22:34:44.149090 [926659ed]         filename: valid_without_unseen.del
2022-03-15 22:34:44.149095 [926659ed]         size: 20000
2022-03-15 22:34:44.149100 [926659ed]         type: triples
2022-03-15 22:34:44.149106 [926659ed]     name: fbwq_full
2022-03-15 22:34:44.149111 [926659ed]     num_entities: 1886683
2022-03-15 22:34:44.149116 [926659ed]     num_relations: 572
2022-03-15 22:34:44.149122 [926659ed]     pickle: true
2022-03-15 22:34:44.149127 [926659ed]   entity_ranking:
2022-03-15 22:34:44.149133 [926659ed]     chunk_size: -1
2022-03-15 22:34:44.149138 [926659ed]     class_name: EntityRankingJob
2022-03-15 22:34:44.149144 [926659ed]     filter_splits:
2022-03-15 22:34:44.149149 [926659ed]     - train
2022-03-15 22:34:44.149154 [926659ed]     - valid
2022-03-15 22:34:44.149159 [926659ed]     filter_with_test: true
2022-03-15 22:34:44.149165 [926659ed]     hits_at_k_s:
2022-03-15 22:34:44.149170 [926659ed]     - 1
2022-03-15 22:34:44.149175 [926659ed]     - 3
2022-03-15 22:34:44.149181 [926659ed]     - 10
2022-03-15 22:34:44.149186 [926659ed]     - 50
2022-03-15 22:34:44.149191 [926659ed]     - 100
2022-03-15 22:34:44.149197 [926659ed]     - 200
2022-03-15 22:34:44.149202 [926659ed]     - 300
2022-03-15 22:34:44.149207 [926659ed]     - 400
2022-03-15 22:34:44.149213 [926659ed]     - 500
2022-03-15 22:34:44.149218 [926659ed]     - 1000
2022-03-15 22:34:44.149223 [926659ed]     metrics_per:
2022-03-15 22:34:44.149228 [926659ed]       argument_frequency: false
2022-03-15 22:34:44.149234 [926659ed]       head_and_tail: false
2022-03-15 22:34:44.149239 [926659ed]       relation_type: false
2022-03-15 22:34:44.149244 [926659ed]     tie_handling:
2022-03-15 22:34:44.149249 [926659ed]       atol: 1e-05
2022-03-15 22:34:44.149254 [926659ed]       rtol: 1e-04
2022-03-15 22:34:44.149260 [926659ed]       type: rounded_mean_rank
2022-03-15 22:34:44.149265 [926659ed]       warn_only: true
2022-03-15 22:34:44.149270 [926659ed]   eval:
2022-03-15 22:34:44.149275 [926659ed]     batch_size: 32
2022-03-15 22:34:44.149281 [926659ed]     num_workers: 5
2022-03-15 22:34:44.149286 [926659ed]     pin_memory: false
2022-03-15 22:34:44.149291 [926659ed]     split: valid
2022-03-15 22:34:44.149297 [926659ed]     trace_level: epoch
2022-03-15 22:34:44.149302 [926659ed]     type: entity_ranking
2022-03-15 22:34:44.149307 [926659ed]   grid_search:
2022-03-15 22:34:44.149313 [926659ed]     class_name: GridSearchJob
2022-03-15 22:34:44.149318 [926659ed]     parameters:
2022-03-15 22:34:44.149323 [926659ed]       +++: +++
2022-03-15 22:34:44.149328 [926659ed]     run: true
2022-03-15 22:34:44.149334 [926659ed]   import:
2022-03-15 22:34:44.149339 [926659ed]   - simple
2022-03-15 22:34:44.149344 [926659ed]   job:
2022-03-15 22:34:44.149349 [926659ed]     device: cuda
2022-03-15 22:34:44.149355 [926659ed]     type: train
2022-03-15 22:34:44.149360 [926659ed]   lookup_embedder:
2022-03-15 22:34:44.149365 [926659ed]     class_name: LookupEmbedder
2022-03-15 22:34:44.149370 [926659ed]     dim: 100
2022-03-15 22:34:44.149376 [926659ed]     dropout: 0.0
2022-03-15 22:34:44.149382 [926659ed]     initialize: normal_
2022-03-15 22:34:44.149387 [926659ed]     initialize_args:
2022-03-15 22:34:44.149392 [926659ed]       +++: +++
2022-03-15 22:34:44.149398 [926659ed]     normalize:
2022-03-15 22:34:44.149403 [926659ed]       p: -1.0
2022-03-15 22:34:44.149408 [926659ed]     pretrain:
2022-03-15 22:34:44.149413 [926659ed]       ensure_all: false
2022-03-15 22:34:44.149419 [926659ed]       model_filename: ''
2022-03-15 22:34:44.149424 [926659ed]     regularize: lp
2022-03-15 22:34:44.149429 [926659ed]     regularize_args:
2022-03-15 22:34:44.149435 [926659ed]       +++: +++
2022-03-15 22:34:44.149440 [926659ed]       p: 2
2022-03-15 22:34:44.149445 [926659ed]       weighted: false
2022-03-15 22:34:44.149450 [926659ed]     regularize_weight: 0.0
2022-03-15 22:34:44.149456 [926659ed]     round_dim_to: []
2022-03-15 22:34:44.149461 [926659ed]     sparse: false
2022-03-15 22:34:44.149466 [926659ed]   manual_search:
2022-03-15 22:34:44.149472 [926659ed]     class_name: ManualSearchJob
2022-03-15 22:34:44.149477 [926659ed]     configurations: []
2022-03-15 22:34:44.149482 [926659ed]     run: true
2022-03-15 22:34:44.149488 [926659ed]   model: simple
2022-03-15 22:34:44.149493 [926659ed]   modules:
2022-03-15 22:34:44.149498 [926659ed]   - kge.job
2022-03-15 22:34:44.149503 [926659ed]   - kge.model
2022-03-15 22:34:44.149509 [926659ed]   - kge.model.embedder
2022-03-15 22:34:44.149514 [926659ed]   negative_sampling:
2022-03-15 22:34:44.149519 [926659ed]     class_name: TrainingJobNegativeSampling
2022-03-15 22:34:44.149524 [926659ed]     filtering:
2022-03-15 22:34:44.149530 [926659ed]       implementation: fast_if_available
2022-03-15 22:34:44.149535 [926659ed]       o: false
2022-03-15 22:34:44.149540 [926659ed]       p: false
2022-03-15 22:34:44.149553 [926659ed]       s: false
2022-03-15 22:34:44.149559 [926659ed]       split: ''
2022-03-15 22:34:44.149564 [926659ed]     frequency:
2022-03-15 22:34:44.149569 [926659ed]       smoothing: 1
2022-03-15 22:34:44.149575 [926659ed]     implementation: auto
2022-03-15 22:34:44.149580 [926659ed]     num_samples:
2022-03-15 22:34:44.149585 [926659ed]       o: -1
2022-03-15 22:34:44.149591 [926659ed]       p: 0
2022-03-15 22:34:44.149596 [926659ed]       s: 3
2022-03-15 22:34:44.149601 [926659ed]     sampling_type: uniform
2022-03-15 22:34:44.149606 [926659ed]     shared: false
2022-03-15 22:34:44.149611 [926659ed]     shared_type: default
2022-03-15 22:34:44.149617 [926659ed]     with_replacement: true
2022-03-15 22:34:44.149622 [926659ed]   random_seed:
2022-03-15 22:34:44.149627 [926659ed]     default: -1
2022-03-15 22:34:44.149632 [926659ed]     numba: -1
2022-03-15 22:34:44.149637 [926659ed]     numpy: -1
2022-03-15 22:34:44.149643 [926659ed]     python: -1
2022-03-15 22:34:44.149648 [926659ed]     torch: -1
2022-03-15 22:34:44.149653 [926659ed]   search:
2022-03-15 22:34:44.149658 [926659ed]     device_pool:
2022-03-15 22:34:44.149663 [926659ed]     - cuda:0
2022-03-15 22:34:44.149669 [926659ed]     - cuda:1
2022-03-15 22:34:44.149674 [926659ed]     - cuda:2
2022-03-15 22:34:44.149679 [926659ed]     - cuda:3
2022-03-15 22:34:44.149684 [926659ed]     num_workers: 1
2022-03-15 22:34:44.149689 [926659ed]     on_error: abort
2022-03-15 22:34:44.149695 [926659ed]     type: ax_search
2022-03-15 22:34:44.149700 [926659ed]   simple:
2022-03-15 22:34:44.149705 [926659ed]     class_name: SimplE
2022-03-15 22:34:44.149710 [926659ed]     entity_embedder:
2022-03-15 22:34:44.149716 [926659ed]       +++: +++
2022-03-15 22:34:44.149721 [926659ed]       type: lookup_embedder
2022-03-15 22:34:44.149726 [926659ed]     relation_embedder:
2022-03-15 22:34:44.149731 [926659ed]       +++: +++
2022-03-15 22:34:44.149737 [926659ed]       type: lookup_embedder
2022-03-15 22:34:44.149742 [926659ed]   train:
2022-03-15 22:34:44.149747 [926659ed]     abort_on_nan: true
2022-03-15 22:34:44.149753 [926659ed]     auto_correct: false
2022-03-15 22:34:44.149758 [926659ed]     batch_size: 32
2022-03-15 22:34:44.149763 [926659ed]     checkpoint:
2022-03-15 22:34:44.149769 [926659ed]       every: 5
2022-03-15 22:34:44.149774 [926659ed]       keep: 3
2022-03-15 22:34:44.149779 [926659ed]       keep_init: true
2022-03-15 22:34:44.149784 [926659ed]     loss: kl
2022-03-15 22:34:44.149790 [926659ed]     loss_arg: .nan
2022-03-15 22:34:44.149795 [926659ed]     lr_scheduler: ''
2022-03-15 22:34:44.149800 [926659ed]     lr_scheduler_args:
2022-03-15 22:34:44.149805 [926659ed]       +++: +++
2022-03-15 22:34:44.149811 [926659ed]     lr_warmup: 0
2022-03-15 22:34:44.149816 [926659ed]     max_epochs: 5
2022-03-15 22:34:44.149821 [926659ed]     num_workers: 5
2022-03-15 22:34:44.149826 [926659ed]     optimizer:
2022-03-15 22:34:44.149831 [926659ed]       +++: +++
2022-03-15 22:34:44.149837 [926659ed]       default:
2022-03-15 22:34:44.149842 [926659ed]         args:
2022-03-15 22:34:44.149847 [926659ed]           +++: +++
2022-03-15 22:34:44.149852 [926659ed]           lr: 0.1
2022-03-15 22:34:44.149857 [926659ed]           weight_decay: 4.0e-08
2022-03-15 22:34:44.149863 [926659ed]         type: Adagrad
2022-03-15 22:34:44.149868 [926659ed]     pin_memory: false
2022-03-15 22:34:44.149873 [926659ed]     split: train
2022-03-15 22:34:44.149879 [926659ed]     subbatch_auto_tune: true
2022-03-15 22:34:44.149884 [926659ed]     subbatch_size: -1
2022-03-15 22:34:44.149889 [926659ed]     trace_level: epoch
2022-03-15 22:34:44.149894 [926659ed]     type: KvsAll
2022-03-15 22:34:44.149900 [926659ed]     visualize_graph: false
2022-03-15 22:34:44.149905 [926659ed]   training_loss:
2022-03-15 22:34:44.149910 [926659ed]     class_name: TrainingLossEvaluationJob
2022-03-15 22:34:44.149915 [926659ed]   user:
2022-03-15 22:34:44.149920 [926659ed]     +++: +++
2022-03-15 22:34:44.149926 [926659ed]   valid:
2022-03-15 22:34:44.149931 [926659ed]     early_stopping:
2022-03-15 22:34:44.149936 [926659ed]       patience: 5
2022-03-15 22:34:44.149941 [926659ed]       threshold:
2022-03-15 22:34:44.149946 [926659ed]         epochs: 0
2022-03-15 22:34:44.149952 [926659ed]         metric_value: 0.0
2022-03-15 22:34:44.149957 [926659ed]     every: 1
2022-03-15 22:34:44.149962 [926659ed]     metric: mean_reciprocal_rank_filtered
2022-03-15 22:34:44.149967 [926659ed]     metric_expr: float("nan")
2022-03-15 22:34:44.149973 [926659ed]     metric_max: true
2022-03-15 22:34:44.149978 [926659ed]     split: valid
2022-03-15 22:34:44.149983 [926659ed]     trace_level: epoch
2022-03-15 22:34:44.232632 [926659ed]   git commit: 5619f4b
2022-03-15 22:34:47.745208 [926659ed]   3658662 distinct sp pairs in train
2022-03-15 22:34:48.405089 [926659ed]   996243 distinct po pairs in train
2022-03-15 22:34:48.406310 [926659ed] Saving checkpoint to ./config/checkpoint_00000.pt...
2022-03-15 22:35:06.245073 [926659ed] Starting training...
2022-03-15 22:35:06.245762 [926659ed] Starting epoch 1...
2022-03-15 22:35:07.046296 [926659ed] CUDA memory after first batch: allocated= 2,265,611,264 reserved= 8,027,897,856 max_allocated= 5,904,850,944
